!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.LiteRouter=n()}(this,function(){"use strict";function t(t,n){return function(){return t.apply(this,arguments)}}function n(t){var n=t.match(/^https?:\/\/[^\/]*/);return null==n?t:t.substring(n[0].length)}function e(t){var e=n(t),r="",o="",i=e.indexOf("#");-1!==i&&(o=e.substring(i),e=e.substring(0,i));var a=e.indexOf("?");return-1!==a&&(r=e.substring(a),e=e.substring(0,a)),""===e&&(e="/"),{pathname:e,search:r,hash:o}}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return"string"==typeof t&&(t=e(t)),"object"==typeof n&&(t=P({},t,{state:n}),n=r||L,r=o),{pathname:t.pathname||"/",search:t.search||"",hash:t.hash||"",state:t.state||null,action:n,key:r}}function o(t,n,e){t.addEventListener?t.addEventListener(n,e,!1):t.attachEvent("on"+n,e)}function i(t,n,e){t.removeEventListener?t.removeEventListener(n,e,!1):t.detachEvent("on"+n,e)}function a(){return window.location.href.split("#")[1]||""}function u(t){window.location.replace(window.location.pathname+window.location.search+"#"+t)}function c(t){t&&window.history.go(t)}function f(t,n){n(window.confirm(t))}function s(){return-1===navigator.userAgent.indexOf("Firefox")}function l(t){return B+t}function p(t,n){try{null==n?window.sessionStorage.removeItem(l(t)):window.sessionStorage.setItem(l(t),JSON.stringify(n))}catch(t){if(t.name===I)return;if(C.indexOf(t.name)>=0&&0===window.sessionStorage.length)return;throw t}}function h(t){var n=void 0;try{n=window.sessionStorage.getItem(l(t))}catch(t){if(t.name===I)return null}if(n)try{return JSON.parse(n)}catch(t){}return null}function d(t,n){return n={exports:{}},t(n,n.exports),n.exports}function v(t,n,e){function r(){a=!0,u?f=[].concat(z.call(arguments)):e.apply(this,arguments)}function o(){if(!a&&(c=!0,!u)){for(u=!0;!a&&t>i&&c;)c=!1,n.call(this,i++,o,r);u=!1,a?e.apply(this,f):i>=t&&c&&(a=!0,e())}}var i=0,a=!1,u=!1,c=!1,f=void 0;o()}function g(t,n,e){var r=t(n,e);2>t.length&&e(r)}function y(t){return Math.random().toString(36).substr(2,t)}function m(t,n){return t.pathname===n.pathname&&t.search===n.search&&t.key===n.key&&U(t.state,n.state)}function w(){function n(){return P&&P.action===L?j.indexOf(P.key):T?j.indexOf(T.key):-1}function o(t){var e=n();(T=t).action===H?j=[].concat(j.slice(0,e+1),[T.key]):T.action===A&&(j[e]=T.key),S.forEach(function(t){t(T)})}function i(t,n){v(x.length,function(n,e,r){g(x[n],t,function(t){null!=t?r(t):e()})},function(t){k&&"string"==typeof t?k(t,function(t){n(!1!==t)}):n(!1!==t)})}function a(t){T&&m(T,t)||(P=t,i(t,function(n){if(P===t)if(n){if(t.action===H){var e=s(T);s(t)===e&&U(T.state,t.state)&&(t.action=A)}!1!==w(t)&&o(t)}else if(T&&t.action===L){var r=j.indexOf(T.key),i=j.indexOf(t.key);-1!==r&&-1!==i&&O(r-i)}}))}function u(t){a(l(t,H,f()))}function c(t){a(l(t,A,f()))}function f(){return y(E)}function s(t){if(null==t||"string"==typeof t)return t;var n=t.pathname,e=t.search,r=t.hash,o=n;return e&&(o+=e),r&&(o+=r),o}function l(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f();return"object"==typeof n&&("string"==typeof t&&(t=e(t)),t=K({},t,{state:n}),n=o,o=arguments[3]||f()),r(t,n,o)}function p(t,n){t.state=K({},t.state,n),b(t.key,t.state)}var h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=h.getCurrentLocation,w=h.finishTransition,b=h.saveState,O=h.go,k=h.getUserConfirmation,E=h.keyLength;"number"!=typeof E&&(E=M);var x=[],j=[],S=[],T=void 0,P=void 0;return{listenBefore:function(t){return x.push(t),function(){x=x.filter(function(n){return n!==t})}},listen:function(t){if(S.push(t),T)t(T);else{var n=d();j=[n.key],o(n)}return function(){S=S.filter(function(n){return n!==t})}},transitionTo:a,push:u,replace:c,go:O,goBack:function(){O(-1)},goForward:function(){O(1)},createKey:f,createPath:s,createHref:function(t){return s(t)},createLocation:l,setState:t(function(t){T?(p(T,t),o(T)):p(d(),t)},"setState is deprecated; use location.key to save state instead"),registerTransitionHook:t(function(t){-1===x.indexOf(t)&&x.push(t)},"registerTransitionHook is deprecated; use listenBefore instead"),unregisterTransitionHook:t(function(t){x=x.filter(function(n){return n!==t})},"unregisterTransitionHook is deprecated; use the callback returned from listenBefore instead"),pushState:t(function(t,n){"string"==typeof n&&(n=e(n)),u(K({state:t},n))},"pushState is deprecated; use push instead"),replaceState:t(function(t,n){"string"==typeof n&&(n=e(n)),c(K({state:t},n))},"replaceState is deprecated; use replace instead")}}function b(t){var n=w(Z({getUserConfirmation:f},t,{go:c}));return Z({},n,{listen:function(t){return R||T(!1),n.listen(t)}})}function O(t){return"string"==typeof t&&"/"===t.charAt(0)}function k(){var t=a();return!!O(t)||(u("/"+t),!1)}function E(t,n,e){return t+(-1===t.indexOf("?")?"?":"&")+n+"="+e}function x(t,n){return t.replace(RegExp("[?&]?"+n+"=[a-zA-Z0-9]+"),"")}function j(t,n){var e=t.match(RegExp("\\?.*?\\b"+n+"=(.+?)\\b"));return e&&e[1]}function S(){function t(){var t=a(),n=void 0,r=void 0;c?(n=j(t,c),t=x(t,c),n?r=h(n):(r=null,n=f.createKey(),u(E(t,c,n)))):n=r=null;var o=e(t);return f.createLocation($({},o,{state:r}),void 0,n)}function n(n){function e(){k()&&r(t())}var r=n.transitionTo;return k(),o(window,"hashchange",e),function(){i(window,"hashchange",e)}}var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R||T(!1);var c=r.queryKey;(void 0===c||c)&&(c="string"==typeof c?c:F);var f=b($({},r,{getCurrentLocation:t,finishTransition:function(t){var n=t.basename,e=t.pathname,r=t.search,o=t.state,i=t.action,f=t.key;if(i!==L){var s=(n||"")+e+r;c?(s=E(s,c,f),p(f,o)):t.key=t.state=null;var l=a();i===H?l!==s&&(window.location.hash=s):l!==s&&u(s)}},saveState:p})),l=0,d=void 0;s();return $({},f,{listenBefore:function(t){1==++l&&(d=n(f));var e=f.listenBefore(t);return function(){e(),0==--l&&d()}},listen:function(t){1==++l&&(d=n(f));var e=f.listen(t);return function(){e(),0==--l&&d()}},push:function(t){f.push(t)},replace:function(t){f.replace(t)},go:function(t){f.go(t)},createHref:function(t){return"#"+f.createHref(t)},registerTransitionHook:function(t){1==++l&&(d=n(f)),f.registerTransitionHook(t)},unregisterTransitionHook:function(t){f.unregisterTransitionHook(t),0==--l&&d()},pushState:function(t,n){f.pushState(t,n)},replaceState:function(t,n){f.replaceState(t,n)}})}var T=function(t,n,e,r,o,i,a,u){if(!t){var c;if(void 0===n)c=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[e,r,o,i,a,u],s=0;(c=Error(n.replace(/%s/g,function(){return f[s++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},H="PUSH",A="REPLACE",L="POP",P=Object.assign||function(t){for(var n=1;arguments.length>n;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},R=!("undefined"==typeof window||!window.document||!window.document.createElement),B="@@History/",C=["QuotaExceededError","QUOTA_EXCEEDED_ERR"],I="SecurityError",_=d(function(t,n){function e(t){var n=[];for(var e in t)n.push(e);return n}(t.exports="function"==typeof Object.keys?Object.keys:e).shim=e}),D=d(function(t,n){function e(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function r(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}var o="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();(n=t.exports=o?e:r).supported=e,n.unsupported=r}),U=d(function(t){function n(t){return null===t||void 0===t}function e(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&(0>=t.length||"number"==typeof t[0]))}function r(t,r,a){var u,c;if(n(t)||n(r))return!1;if(t.prototype!==r.prototype)return!1;if(D(t))return!!D(r)&&(t=o.call(t),r=o.call(r),i(t,r,a));if(e(t)){if(!e(r))return!1;if(t.length!==r.length)return!1;for(u=0;t.length>u;u++)if(t[u]!==r[u])return!1;return!0}try{var f=_(t),s=_(r)}catch(t){return!1}if(f.length!=s.length)return!1;for(f.sort(),s.sort(),u=f.length-1;u>=0;u--)if(f[u]!=s[u])return!1;for(u=f.length-1;u>=0;u--)if(c=f[u],!i(t[c],r[c],a))return!1;return typeof t==typeof r}var o=Array.prototype.slice,i=t.exports=function(t,n,e){return e||(e={}),t===n||(t instanceof Date&&n instanceof Date?t.getTime()===n.getTime():!t||!n||"object"!=typeof t&&"object"!=typeof n?e.strict?t===n:t==n:r(t,n,e))}}),z=Array.prototype.slice,K=Object.assign||function(t){for(var n=1;arguments.length>n;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},M=6,Z=Object.assign||function(t){for(var n=1;arguments.length>n;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},$=Object.assign||function(t){for(var n=1;arguments.length>n;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},F="_k",J=function(t){if(t instanceof RegExp)return function(n){return null!==n.match(t)&&{}};if("*"===t)return function(){return{}};var n=/:([a-zA-Z_$][a-zA-Z0-9_$]*)/g,e=t.match(n);if(null!==e){e=e.map(function(t){return t.slice(1)});var r=t.replace(/:([^\/]+)/g,"([^/?#]+)");return function(t){var n=t.match(RegExp("^"+r+"$"));return null!==n&&n.reduce(function(t,n,r){return r>0&&(t[e[r-1]]=n),t},{})}}return function(n){return n===t&&{}}},N=function(t){return t.map(function(t){if(void 0===t.pattern||void 0===t.handler)throw Error("Missing pattern or handler attribute");if(void 0!==t.resolve&&void 0===t.resolve.then)throw Error("resolve param only accepts promises");return{matcher:J(t.pattern),handler:t.handler,resolve:t.resolve}})},Q=function(t){return function(n){return t.reduce(function(t,e){var r=e.matcher(n);return r&&0===t.length&&t.push({handler:e.handler,resolve:e.resolve,params:r}),t},[]).reduce(function(t,n){return t||n},null)}};return function(t){var n=S(),e=N(t),r=Q(e),o=null,i=function(){};return n.listen(function(t){var e=r(t.pathname);e&&o!==t.pathname&&(e.resolve?e.resolve.then(function(){i({location:t,params:e.params,history:n}),o=t.pathname,i=e.handler({location:t,params:e.params,history:n}),T(!(void 0===i),"Handler matching "+t.pathname+" should return an unmount function.")}):(i({location:t,params:e.params,history:n}),o=t.pathname,i=e.handler({location:t,params:e.params,history:n}),T(!(void 0===i),"Handler matching "+t.pathname+" should return an unmount function.")))})}});
